---
title: Bayesian Statistics - A Very Short Introduction
date: "`r Sys.Date()`"
author: "Tim Newbold"
output:
  rmdformats::downcute:
  code_folding: show
self_contained: true
thumbnails: false
lightbox: true
---

# Introduction and Further Reading

This tutorial only covers the running of some basic Bayesian models using the _brms_ package. If you want to delve further into the world of Bayesian statistics, including specification of priors and more complex models, I strongly recommend Richard McElreath's book:

McElreath, R. (2020). <i> Statistical Rethinking: A Bayesian Course with Examples in R and Stan</i>. 2nd Edition. CRC Press, Boca Raton, USA.

```{r, echo=TRUE, eval=TRUE, results=TRUE, warning=FALSE, message=FALSE}
library(ggplot2)
library(brms)
```

# Bayesian Linear Regression

## Dataset

We will work with the R dataset that we used for the [main linear regression tutorial](./LinearRegression.html), describing various socio-economic measures from Swiss cantons in 1888. Specifically, we will focus again on the relationship between % of people receiving post-primary education and standardized average fertility.

```{r, echo=TRUE, eval=TRUE, results=TRUE, warning=FALSE, message=FALSE}
data(swiss)
head(swiss)

ggplot(data = swiss,mapping = aes(x=Education,y=Fertility)) + 
  geom_point() + 
  geom_smooth(method = 'lm') + 
  scale_x_continuous(transform = 'log10') + 
  theme_classic()
```

## Running the Model

As a reminder, we had previously run a standard (Ordinary Least Squares) linear regression to assess the relationship between these two variables.

```{r, echo=TRUE, eval=TRUE, results=TRUE, warning=FALSE, message=FALSE}
m.ols <- lm(formula = Fertility ~ log10(Education),data = swiss)

summary(m.ols)
```

To run an equivalent Bayesian model using the _brms_ package is really simple. We just use the _brm_ function instead of the standard _lm_ function (although note that it does take much longer to run, because the algorithm must now sample parameter space, since there isn't a simple analytical solution as with classical linear regression).

```{r, echo=TRUE, eval=TRUE, results=TRUE, warning=FALSE, message=FALSE}
m1.bayes <- brm(formula = Fertility ~ log10(Education),data = swiss)

summary(m1.bayes)
```

You can see that the model output gives some familiar information, such as coefficient estimates along with associated uncertainty. Remember that estimated uncertainty with Bayesian models is derived from the posterior samples of parameter space.

If you compare the coefficients estimated by the Bayesian model and by the standard linear regression, you will see that they are very similar.

## Checking the Model

```{r, echo=TRUE, eval=TRUE, results=TRUE, warning=FALSE, message=FALSE}
plot(m1.bayes)
```

## Predictions and Plotting

```{r, echo=TRUE, eval=TRUE, results=TRUE, warning=FALSE, message=FALSE}
preds <- conditional_effects(m1)

ggplot() + 
  geom_point(data = swiss,mapping = aes(x = Education,y = Fertility)) + 
  scale_x_continuous(transform = 'log10') + 
  geom_line(data = preds$Education,mapping = aes(x = Education,y=estimate__),
            colour="#2E2585",size=1) + 
  geom_ribbon(data = preds$Education,mapping = aes(
    x = Education,ymin = lower__,ymax = upper__),
    fill = "#2E2585",alpha=0.3) + 
  theme_classic()
```

# Bayesian Generalized Linear Models

# Bayesian Mixed-effects Models